<!DOCTYPE html>
<html>
<head>
  <style>
    #the-canvas {
      border: none;
      background: #000;
      width: 500px;
      height: 500px
    }
  </style>
  <script>
    // Here's the plan:
    // 1) Create a canvas
    // 2) Get the 3D context
    // 3) Initialize Viewport
    // 4) Create buffers
    // 5) Create transforms 
    // 6) Create shaders
    // 7) Init shaders
    // 8) Draw stuff
    
    // Initialize the 3D context and return it for later use
    // @param canvas - the canvas on the page
    // @return the initialized WebGL context
    function initWebGl(canvas) {
      var gl;
      try {
        // Just like before when you grabbed the '2D' context from the canvas, WebGL needs a special context to draw to
        gl = canvas.getContext('experimental-webgl');
        console.log("WebGL context successfully initialized!");
      } catch (e) {
        var errorMsg = "Error when trying to create WebGL context: " + e.toString();
        alert(errorMsg);
        throw Error(errorMsg);
      }
      return gl;
    }

    // Initialize the viewport for the WebGL context
    // @param gl - the WebGL context
    // @param canvas - the canvas on the page
    function initViewport(gl, canvas) {
      // This says from (0,0) to the width & height of the canvas
      gl.viewport(0, 0, canvas.width, canvas.height);
    }

    // Create the vertex buffer data for one square to be drawn.
    // @param gl - the WebGL context
    // @return the vertex data for the square
    function createSquare(gl) {
      var vertexBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
      var verts = [
          0,  .5,  0.0,
          -1,  .5,  0.0,
          0, -.5,  0.0,
          -1, -.5,  0.0
      ];
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(verts), gl.STATIC_DRAW);
      // Notice that we list how many vertices it has (nVerts)
      var square = {buffer:vertexBuffer, vertSize:3, nVerts:4, primtype:gl.TRIANGLE_STRIP};
      return square;
    }

    // Same idea as above, but now it's creating a triangle
    // @param gl - the WebGL context
    // @return the vertex data for the triangle
    function createTriangle(gl) {
      var vertexBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
      var verts = [
          .5,  .5,  0.0,
          1, -.5,  0.0,
          0, -.5,  0.0
      ];
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(verts), gl.STATIC_DRAW);
      var triangle = {buffer:vertexBuffer, vertSize:3, nVerts:3, primtype:gl.TRIANGLE_STRIP};
      return triangle;
    }

    function start() {
      var canvas = document.getElementById('the-canvas');
      var gl = initWebGl(canvas);
      initViewport(gl, canvas);
      var square = createSquare(gl);
      var triangle = createTriangle(gl);
    }

  </script>
</head>
<body onload="start()">
  <div id="canvas-container">
    <canvas id="the-canvas"></canvas>
  </div>
</body>
</html>
